<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Product Details | Minikids</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" />
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
  <link rel="stylesheet" href="style.css" />
  <style>
.small-img {
  cursor: pointer;
  transition: opacity .25s;
}
.small-img:hover {
  opacity: .7;
}

  </style>
</head>
<body>
  <!-- Header -->
  <header class="site-header py-3">
    <div class="container d-flex flex-wrap align-items-center justify-content-between">
      <img src="img/logo.jpg" alt="Logo" class="site-logo" />
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <form class="search-wrapper flex-grow-1 mx-4" style="position: relative;">
      <input type="search" class="form-control search-input" placeholder="Search" id="searchBox" autocomplete="off" />
      <div id="searchSuggestions" class="suggestion-box"></div>
      </form>

      <nav class="icon-bar d-flex gap-4 flex-wrap">
        <a href="#" class="icon-link active"><span class="material-icons">home</span> Home</a>
        <a href="shop.html" class="icon-link"><span class="material-icons">store</span> Store</a>
        <a href="account.html" class="icon-link d-flex align-items-center">
          <span class="material-icons">person</span>
          <span class="d-none d-sm-inline ms-1">Account</span>
        </a>
        <a href="wishlist.html" class="icon-link d-flex align-items-center position-relative">
          <span class="material-icons">favorite</span>
          <span class="d-none d-sm-inline ms-1">Wishlist</span>
          <span id="wishlist-count" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">0</span>
        </a>
        <a href="cart.html" class="icon-link position-relative">
          <span class="material-icons">shopping_bag</span>
          <span id="cart-count" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">0</span>
        </a>
      </nav>
    </div>
  </header>

  <!-- Product Section -->
  <section class="container sproduct my-5 pt-5">
    <div class="row" id="product-detail"></div>
    <div id="cart-message" class="alert alert-success mt-3 d-none" role="alert">Added to cart successfully!</div>
  </section>

  <!-- Footer -->
  <footer class="mt-5 py-5">
    <div class="container">
      <div class="row">
        <div class="col-lg-3 col-md-6 mb-4">
          <img src="img/logo.jpg" alt="Logo" class="img-fluid mb-3">
          <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Sit perspiciatis cum.</p>
        </div>
        <div class="col-lg-3 col-md-6 mb-4">
          <h5>ACCOUNT & FAQS</h5>
          <ul class="list-unstyled">
            <li><a href="#">My Orders</a></li>
            <li><a href="#">Help Centre</a></li>
            <li><a href="#">Log In / Register</a></li>
            <li><a href="#">Track Order</a></li>
          </ul>
        </div>
        <div class="col-lg-3 col-md-6 mb-4">
          <h5>GET TO KNOW US</h5>
          <ul class="list-unstyled">
            <li><a href="#">The Brand</a></li>
            <li><a href="#">Store Locator</a></li>
            <li><a href="#">Button Rewards</a></li>
            <li><a href="#">Sustainability</a></li>
            <li><a href="#">Miniklub Policy</a></li>
          </ul>
        </div>
        <div class="col-lg-3 col-md-6 mb-4">
          <h5>SUBSCRIBE TO OUR NEWSLETTER</h5>
          <p>Sign up to receive our latest news and offers available only to subscribers.</p>
          <div class="newsletter-box">
            <input type="email" placeholder="Enter your email address" />
            <button type="submit">Subscribe</button>
          </div>
        </div>
      </div>
      <div class="row mt-4 align-items-center">
        <div class="col-lg-4 col-md-6">
          <p>© 2025 Minikidss eCommerce. All rights reserved.</p>
        </div>
        <div class="col-lg-4 col-md-6 text-center text-md-end">
          <a href="#">Terms & Conditions</a>
          <a href="#">FAQs</a>
          <a href="#">Cookie Policy</a>
          <a href="#">Privacy Policy</a>
        </div>
        <div class="col-lg-4 mt-3 mt-lg-0 text-center">
          <div class="social-icons">
            <a href="#"><img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/facebook.svg" alt="Facebook"></a>
            <a href="#"><img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/instagram.svg" alt="Instagram"></a>
            <a href="#"><img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/linkedin.svg" alt="LinkedIn"></a>
            <a href="#"><img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/youtube.svg" alt="YouTube"></a>
          </div>
        </div>
      </div>
    </div>
  </footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"></script>
  <script src="products.js"></script>
  <script src="cart.js"></script>

  <script>
  /* ---------- Live Search (global) ---------- */
  document.addEventListener("DOMContentLoaded", () => {
    const searchBox = document.getElementById("searchBox");
    const suggestions = document.getElementById("searchSuggestions");
    if (!searchBox || !suggestions) return;

    searchBox.addEventListener("input", () => {
      const q = searchBox.value.trim().toLowerCase();
      if (!q) { suggestions.style.display = "none"; return; }
      const hits = window.allProducts.filter(p => p.name.toLowerCase().includes(q)).slice(0,6);
      suggestions.innerHTML = hits.length
        ? hits.map(p=>`<a href="product.html?id=${p.id}" class="list-group-item list-group-item-action d-flex align-items-center">
                         <img src="${p.images[0]}" style="width:40px;height:40px;object-fit:cover;margin-right:10px">
                         <span>${p.name}</span></a>`).join("")
        : `<div class="list-group-item text-muted">No products found</div>`;
      suggestions.style.display = "block";
    });
    document.addEventListener("click",e=>{
      if(!searchBox.contains(e.target)&&!suggestions.contains(e.target))
        suggestions.style.display="none";
    });
  });

  /* ---------- Wishlist toggle ---------- */
  function toggleWishlist(id){
    let wl = JSON.parse(localStorage.getItem("wishlist"))||[];
    wl = wl.includes(id) ? wl.filter(x=>x!==id) : [...wl,id];
    localStorage.setItem("wishlist",JSON.stringify(wl));
    alert("Wishlist updated");
  }

  /* ---------- Product Detail Renderer ---------- */
  function renderProductDetails(){
    const id = Number(new URLSearchParams(location.search).get("id"));
    if(!id) return;
    const p = window.allProducts.find(x=>x.id===id);
    const target = document.getElementById("product-detail");
    if(!p || !target) return;

    /* colour dropdown */
    const colorDD = p.colors?`
      <label class="form-label mt-3" for="colorSelect">Choose Color</label>
      <select id="colorSelect" class="form-select">
        <option disabled selected>Select Color</option>
        ${p.colors.map(c=>`<option>${c}</option>`).join("")}
      </select>`:"";

    target.innerHTML = `
      <div class="col-lg-5">
        <img id="MainImg" src="${p.images[0]}" class="img-fluid w-100 pb-1" alt="${p.name}">
        <div class="small-img-group d-flex gap-2 mt-2 flex-wrap">
          ${p.images.map(img=>`<img src="${img}" class="small-img" style="width:80px;height:80px;border:1px solid #ddd">`).join("")}
        </div>
      </div>

      <div class="col-lg-6">
        <h6>Home / ${p.category}</h6>
        <h3 class="py-4">${p.name}</h3>

        <!-- Price block -->
        <div class="product-price mb-3">
          ${p.mrp && p.mrp>p.price
            ? `<span class="text-muted text-decoration-line-through me-2">₹${p.mrp}</span>`
            : ""}
          <span class="fw-bold fs-4 text-danger">₹${p.price}</span>
          ${p.mrp && p.mrp>p.price
            ? `<span class="badge bg-success ms-2">${Math.round(((p.mrp-p.price)/p.mrp)*100)}% off</span>`
            : ""}
        </div>

        ${colorDD}

        <select id="sizeSelect" class="form-select my-3">
          <option disabled selected>Select Size</option>
          ${p.sizes.map(s=>`<option>${s}</option>`).join("")}
        </select>

        <input id="qtyInput" type="number" value="1" class="form-control mb-3" style="width:120px">

        <button id="addToCartBtn" class="btn btn-primary">Add to Cart</button>
        <button class="btn btn-outline-danger ms-2" onclick="toggleWishlist(${p.id})">Add to Wishlist</button>

        <div id="cart-message" class="alert alert-success mt-3 d-none">Added to cart!</div>

        <h4 class="mt-4">Product Details</h4>
        <span>${p.description||"No description available."}</span>
      </div>`;

    /* thumbnail swap */
    document.querySelectorAll(".small-img").forEach(img=>{
      img.addEventListener("click",e=>{
        document.getElementById("MainImg").src=e.target.src;
      });
    });

    /* color swap */
    if(p.colorImages){
      document.getElementById("colorSelect")?.addEventListener("change",e=>{
        const newImg=p.colorImages[e.target.value];
        if(newImg) document.getElementById("MainImg").src=newImg;
      });
    }

    /* size enable */
    const addBtn=document.getElementById("addToCartBtn");
    const sizeSel=document.getElementById("sizeSelect");
    addBtn.disabled=true;
    sizeSel.addEventListener("change",()=>addBtn.disabled=(sizeSel.value==="Select Size"));

    /* add-to-cart */
    addBtn.addEventListener("click",()=>{
      const qty = Number(document.getElementById("qtyInput").value)||1;
      const size=sizeSel.value;
      if(size==="Select Size") return alert("Please choose a size");

      const cart=JSON.parse(localStorage.getItem("cart"))||[];
      const row=cart.find(i=>i.id===p.id && i.size===size);
      row? row.quantity+=qty
          : cart.push({id:p.id,name:p.name,price:p.price,image:p.images[0],size,quantity:qty});
      localStorage.setItem("cart",JSON.stringify(cart));

      const m=document.getElementById("cart-message");
      m.classList.remove("d-none"); setTimeout(()=>m.classList.add("d-none"),2000);
    });
  }

  document.addEventListener("DOMContentLoaded",renderProductDetails);
  </script>
</body>
</html>