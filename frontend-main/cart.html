<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>My Cart | Minikids</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css"/>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <link rel="stylesheet" href="style.css"/>
</head>
<body>

    <header class="site-header py-3">
    <div class="container d-flex flex-wrap align-items-center justify-content-between">
      <img src="img/logo.jpg" alt="Logo" class="site-logo" />
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <form class="search-wrapper flex-grow-1 mx-4" style="position: relative;">
        <input type="search" class="form-control search-input" placeholder="Search" id="searchBox" autocomplete="off" />
        <div id="searchSuggestions" class="suggestion-box"></div>
      </form>

      <nav class="icon-bar d-flex gap-4 flex-wrap">
        <a href="index.html" class="icon-link active"><span class="material-icons">home</span> Home</a>
        <a href="shop.html" class="icon-link"><span class="material-icons">store</span> Store</a>
        <a href="account.html" class="icon-link d-flex align-items-center">
        <span class="material-icons">person</span>
        <span class="d-none d-sm-inline ms-1">Account</span>
        </a>

        <a href="wishlist.html" class="icon-link d-flex align-items-center position-relative">
        <span class="material-icons">favorite</span>
        <span class="d-none d-sm-inline ms-1">Wishlist</span>
        <span id="wishlist-count" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">0</span>
        </a>

        <a href="cart.html" class="icon-link position-relative">
          <span class="material-icons">shopping_bag</span>
          <span id="cart-count" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">0</span>
        </a>
      </nav>
    </div>
  </header>

  <!-- Cart Section -->
  <section class="container my-5">
    <h2 class="mb-4">Your Shopping Cart</h2>
    <div id="cart-items"></div>
    <div class="text-end mt-4">
      <h4>Total: ₹<span id="cart-total">0</span></h4>
      <button id="checkout-btn" class="btn btn-success mt-2">Proceed to Checkout</button>
    </div>
  </section>

  <!-- Simple Custom Modal -->
  <div class="modal fade" id="actionModal" tabindex="-1" aria-labelledby="actionModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="actionModalLabel">Modify Cart Item</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p>What would you like to do with this item?</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-outline-secondary" id="modal-remove-btn">Remove</button>
          <button type="button" class="btn btn-outline-danger" id="modal-move-btn">Move to Wishlist</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Scripts -->
   <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"></script>
  <script src="products.js"></script>

  <!-- BEGIN new dynamic cart logic (no page reloads) -->
  <script>
  /**********************************************************
      cart.js  (inlined here for simplicity)
  **********************************************************/

  /* === 1. Render cart line-items & totals =============== */
  function renderCart() {
    const container = document.getElementById("cart-items");
    const totalEl   = document.getElementById("cart-total");
    const checkout  = document.getElementById("checkout-btn");
    if (!container || !totalEl) return;

    const cart = JSON.parse(localStorage.getItem("cart")) || [];
    container.innerHTML = "";                              // clear first

    if (cart.length === 0) {
      container.innerHTML = `
        <div class="text-center text-muted py-5">
          <span class="material-icons fs-1 mb-2">shopping_bag</span><br>
          Your cart is empty.
        </div>`;
      totalEl.textContent = "0";
      if (checkout) checkout.disabled = true;
      return;
    }

    /* Build each row dynamically */
    let grand = 0;
    cart.forEach((item, idx) => {
      const lineTotal = item.price * item.quantity;
      grand          += lineTotal;

      const row = document.createElement("div");
      row.className = "row align-items-center g-3 border-bottom py-3";

      row.innerHTML = `
        <div class="col-3 col-md-2">
          <img src="${item.image}" class="img-fluid rounded"/>
        </div>

        <div class="col-9 col-md-3">
          <h6 class="mb-1">${item.name}</h6>
          <small class="text-muted">Size: ${item.size || "N/A"}</small>
        </div>

        <div class="col-4 col-md-2">₹ ${item.price}</div>

        <div class="col-4 col-md-2">
          <input type="number" class="form-control form-control-sm"
                 value="${item.quantity}" min="1"
                 onchange="updateQty(${idx}, this.value)">
        </div>

        <div class="col-4 col-md-2 fw-bold">₹ ${lineTotal}</div>

        <div class="col-12 col-md-1 text-end">
          <button class="btn btn-sm btn-danger"
                  onclick="removeFromCart(${idx})">
            <span class="material-icons" style="font-size:18px">close</span>
          </button>
        </div>
      `;
      container.appendChild(row);
    });

    totalEl.textContent = grand.toLocaleString();
    if (checkout) checkout.disabled = false;
    updateCartCount();           // badge in header
  }

  /* === 2. Update quantity ================================= */
  function updateQty(index, qty) {
    qty = Math.max(1, parseInt(qty) || 1);
    const cart = JSON.parse(localStorage.getItem("cart")) || [];
    cart[index].quantity = qty;
    localStorage.setItem("cart", JSON.stringify(cart));
    renderCart();
  }

  /* === 3. Remove line-item ================================ */
  function removeFromCart(index) {
    const cart = JSON.parse(localStorage.getItem("cart")) || [];
    cart.splice(index, 1);
    localStorage.setItem("cart", JSON.stringify(cart));
    renderCart();
  }

  /* === 4. Header badge helper (shared) ==================== */
  function updateCartCount() {
    const count = (JSON.parse(localStorage.getItem("cart")) || [])
                    .reduce((sum, i) => sum + i.quantity, 0);
    const badge  = document.getElementById("cart-count");
    const mBadge = document.getElementById("cart-count-mobile");
    if (badge)  badge.textContent  = count;
    if (mBadge) mBadge.textContent = count;
  }

  /* === 5. Init on page load =============================== */
  document.addEventListener("DOMContentLoaded", () => {
    renderCart();
    const checkoutBtn = document.getElementById("checkout-btn");
    if (checkoutBtn) {
      checkoutBtn.addEventListener("click", () => {
        if (confirm("Proceed to checkout?")) location.href = "checkout.html";
      });
    }
  });
  </script>
  <!-- END new dynamic cart logic -->
</body>

</html>
